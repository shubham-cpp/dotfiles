#!/usr/bin/env sh

amount=${2:-10}

case "$1" in
  inc)
    pactl set-sink-volume @DEFAULT_SINK@ +"$amount"%
    vol=$(pactl get-sink-volume @DEFAULT_SINK@ | awk -F ' / ' '{print $2}' | tr -cd '[:digit:][=%=]')
    notify-send "Volume" -t 2000 -i audio-volume-high-symbolic -h int:value:"$vol"
    ;;
  dec)
    pactl set-sink-volume @DEFAULT_SINK@ -"$amount"%
    vol=$(pactl get-sink-volume @DEFAULT_SINK@ | awk -F ' / ' '{print $2}' | tr -cd '[:digit:][=%=]')
    notify-send "Volume" -t 2000 -i audio-volume-high-symbolic -h int:value:"$vol"
    ;;
  toggle)
    pactl set-sink-mute @DEFAULT_SINK@ toggle
    ;;
  *)
    echo "Program requires argument inc,dec,toggle"
    exit 1
    ;;
esac

pgrep polybar && polybar-msg action mvol hook 0
pgrep dwmblocks && kill -56 "$(pidof dwmblocks)"
